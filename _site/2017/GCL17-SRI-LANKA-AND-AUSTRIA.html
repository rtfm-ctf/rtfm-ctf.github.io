<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" class="no-js">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta charset="UTF-8">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  
  
  

  <title>
      Write Up GCL17 - SRI LANKA and AUSTRIA · RTFM
  </title>

  
  

  

  <meta name="description" content="
      GCL17 SRI LANKA and AUSTRIA  challenge
  "/>
  <meta name="keywords" content="gcl17, python, rtfm, write up, G4mbl3r">
  <meta name="author" content="Red Team Freakin' Maniacs">

  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">

  
  
  

  <!-- Social: Facebook / Open Graph -->
  
  <meta property="og:type" content="article">
  <meta property="article:author" content="Red Team Freakin' Maniacs">
  <meta property="article:section" content="">
  <meta property="article:tag" content="gcl17, python, rtfm, write up, G4mbl3r">
  <meta property="article:published_time" content="2017-08-12 00:00:00 -0300">
  
  <meta property="og:url" content="http://localhost:4000/2017/GCL17-SRI-LANKA-AND-AUSTRIA">
  <meta property="og:title" content="
      Write Up GCL17 - SRI LANKA and AUSTRIA · RTFM
  ">
  <meta property="og:image" content="http://localhost:4000">
  <meta property="og:description" content="
      GCL17 SRI LANKA and AUSTRIA  challenge
  ">
  <meta property="og:site_name" content="Red Team Freakin' Maniacs">
  <meta property="og:locale" content="en_US">

  <!-- Social: Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@rtfmctf">
  <meta name="twitter:title" content="
      Write Up GCL17 - SRI LANKA and AUSTRIA · RTFM
  ">
  <meta name="twitter:description" content="
      GCL17 SRI LANKA and AUSTRIA  challenge
  ">
  <meta name="twitter:image:src" content="http://localhost:4000">

  <!-- Social: Google+ / Schema.org  -->
  <meta itemprop="name" content="
      Write Up GCL17 - SRI LANKA and AUSTRIA · RTFM
  ">
  <meta itemprop="description" content="
      GCL17 SRI LANKA and AUSTRIA  challenge
  ">
  <meta itemprop="image" content="http://localhost:4000">

  <meta name="msapplication-TileColor" content="#f3f3f3">
  <meta name="theme-color" content="#ffffff">

  <meta name="google-site-verification" content="aSavCGGU0uSN5HEHnI7ZiMqVKxn7mfUPCGMVJvmDQ1w" />
  <meta name="wot-verification" content="6da2597a332a1fadad8f"/>

  <!-- Canonical link tag -->
  <link rel="canonical" href="http://localhost:4000/2017/GCL17-SRI-LANKA-AND-AUSTRIA">
  <link rel="alternate" type="application/rss+xml" title="RSS" href="http://localhost:4000/feed.xml">

  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="stylesheet" href="/assets/css/font-awesome.min.css">

  <script src="/assets/js/modernizr.custom.js"></script>

  <!--[if lt IE 9]>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/respond.js/1.1.0/respond.min.js"></script>
    <script src="/assets/js/rem.min.js"></script>
  <![endif]-->
</head>

  <body>

    <div class="wrap">
      <div class="master-nav">
        <div class="nav">
            <ul class="top-menu">
              <li><a href="/"><i class="fa fa-home"></i> Home</a></li>
              <li><a href="/about.html"><i class="fa fa-user"></i> About</a></li>
              <li><a href="/writeups.html"><i class="fa fa-file-text"></i> Writeups</a></li>
              <li><a href="/events.html"><i class="fa fa-trophy"></i> Events</a></li>
            </ul>
        </div>
      </div>

      <div class="masthead">
        <div class="container">
          <h2 class="masthead-title">
            <p align="center"><img src='/assets/logo.png' width="130px" height="130px" /></p>
            <a href="/" title="Home">Red Team Freakin' Maniacs</a>
            <small></small>
          </h2>

          <div class="footer-social-links">
  <a href="https://www.facebook.com/RedTeamFreakinManiacs" title="Facebook" target="_blank"><i class="fa fa-facebook"></i></a>
  <a href="https://twitter.com/rtfmctf" title="Twitter" target="_blank"><i class="fa fa-twitter"></i></a>
  <a href="https://github.com/rtfm-ctf" title="GitHub" target="_blank"><i class="fa fa-github-alt"></i></a>
  <a href="https://ctftime.org/team/16856" title="CTFTime"><i class="fa fa-terminal"></i></a>
  <a href="mailto:contato@rtfm-ctf.org" title="Contact"><i class="fa fa-comment-o"></i></a>
</div>


        </div>
      </div>

      <div class="container content">
        <div class="post">
  <div class="post-top-meta">
    <div class="post-date">August 12, 2017 &middot; <span class="reading-time" title="Estimated Reading Time">
  
  
    2 minutes read
  
</span>
</div>
    <h1 class="post-title">Write Up GCL17 - SRI LANKA and AUSTRIA</h1>
  </div>

  <ul>
  <li><strong>CTF:</strong> GCL17</li>
  <li><strong>Solved by:</strong> RTFM[G4mbl3r]</li>
</ul>

<h3 id="write-up-sri-lanka">Write Up SRI LANKA</h3>

<p>The first thing to do is to run the “file” command, which will indicate that the file is an elf32. After that the binary was analyzed on r2 and I ended up realizing that I forgot to do the most simple and obvious thing as I am certified SGSE ( Strings grep Specialist Engineer), so I just executed the following command:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	strings -e s c9c18a2c3f65bb8d1f6133765889774a1224cbe993edcc1641275be12b29b10a | less
</code></pre></div></div>
<p>And found the most beautiful string in the world, PYTHON</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	mod is NULL - %s
	PYTHONPATH
	PYTHONHOME
	import sys
	del sys.path[:]
	sys.path.append(r"%s")
	argv
</code></pre></div></div>
<p>Now every thing became simple becasue that just looked like a challenge I’ve created a while ago. So my guess was that It’s just a python code probably compiled with py2exe or pyinstaller just generating some bytecode behind, like java, so I used the pyinstaller decompiler(<img src="https://sourceforge.net/projects/pyinstallerextractor/" alt="PyInstaller Extractor download" />) extracted the code, and executed the following command:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>➜ strings * | grep -R -l t0k3n
pyi_darchive
</code></pre></div></div>

<p>Opened the pyi_darchive file, and there was it,</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>t0k3n1 = [116, 104, 51, 32, 120, 120, 120, 32, 116, 48, 107, 51, 110, 32, 121,
          48, 117, 32, 115, 51, 51, 107, 32, 105, 115, 58, 32, 102, 48, 108,
          108, 48, 119, 32, 116, 104, 51, 32, 114, 52, 98, 98, 49, 116]
</code></pre></div></div>
<p>And to get the ascii, I write the resolv.py</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>t0k3n1 = [116, 104, 51, 32, 120, 120, 120, 32, 116, 48, 107, 51, 110, 32, 121,
          48, 117, 32, 115, 51, 51, 107, 32, 105, 115, 58, 32, 102, 48, 108,
          108, 48, 119, 32, 116, 104, 51, 32, 114, 52, 98, 98, 49, 116]
out = list()
for l in t0k3n1:
    out.append(chr(l))
print ''.join(out)
</code></pre></div></div>
<p>FLAG: th3 xxx t0k3n y0u s33k is: f0ll0w th3 r4bb1t</p>

<h3 id="write-up-austria">Write Up AUSTRIA</h3>
<p>Continuing with this file after the CTF, I just read the rest of the file and found that if I created I file with the coordinates, it will print the flag to me, so debugging the pyi_darchive, I created the file uKBcWeOjxleffzzZmpWXLUrSubOHWzaeVO.wgz, and put the coordinates inside it, because the script compares the content of the file with the values on coords var, so the file looks like that</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>➜ cat uKBcWeOjxleffzzZmpWXLUrSubOHWzaeVO.wgz
33.744970 -84.372165
52.369561 4.893806
38.905475 -77.031695
</code></pre></div></div>

<p>I just run the script, and then here is the flag,</p>

<p>FLAG: the yyy t0k3n y0u s33k is: d33p_1n_th3_0z4rks</p>


</div>
<div class="back"><a href="/"><i class="fa fa-chevron-left"></i> Back to Homepage</a></div>

      </div>
    </div>

    <div class="footer">
	<div class="hrline"></div>
	<div class="copyright"><br>&copy; 2022 Red Team Freakin' Maniacs</div>
</div>

<script>
$(window).load(function() {
	$('.grid').masonry({
		itemSelector: '.grid-item',
		columnWidth: '.grid-sizer',
		gutter: 10
	});
});
</script>


  </body>
</html>
